dir_p_mask = direct_rate >= R_min;